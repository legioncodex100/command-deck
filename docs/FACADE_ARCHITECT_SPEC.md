Module Spec: Pillar H - The Facade Architect (Stitch Orchestrator)

Objective: Bridge visual design from Google Stitch to the Antigravity IDE via a "Perfection Loop" that synchronizes visual intent with functional code.

1. The Stitch Prompt Generator (Stage 2: Design)

Function: Collects high-level visual preferences from the Architect-Pilot and generates a precision prompt for Google Stitch.

Inputs:

Brand Palette: Base HEX codes or mood (e.g., "Professional Dark Finance").

Density: Choice of 'Compact', 'Default', or 'Spacious' (maps to Tailwind spacing scales).

Corner Radius: Choice of 'Sharp', 'Subtle', or 'Round'.

Action: Gemini 2.5 Flash assembles these into a Markdown-formatted prompt that describes layout hierarchy, color accessibility (WCAG), and component density optimized for the Stitch engine.

2. The DNA Extraction (Reverse-Engineer)

Objective: Extract design tokens from the perfected UI code generated by Stitch.

Input: A large text area in the Command Deck UI where the user pastes raw HTML/Tailwind code copied directly from the Stitch editor.

Action: A specialized service (src/services/facade.ts) uses Gemini to parse the <script id="tailwind-config"> block or inline styles to extract:

Color Tokens: HEX values for primary, secondary, surface, and background.

Typography Tokens: Font families, base font size, and heading weights.

Shape Tokens: border-radius values for buttons and cards.

Format: The extracted data is converted into a standard tokens.json structure.

3. The Perfection Loop & Sync

Workflow Step:

Direct: Generate Stitch Prompt in Command Deck.

Perfect: Paste prompt into Stitch, iterate visually, and copy the resulting code.

Reconcile: Paste Stitch code back into Command Deck.

Enforce: Command Deck updates docs/DESIGN.md and generates a CSS variable sheet (globals.css).

Sync: The "Update DESIGN.md" action ensures that construction agents in Antigravity are strictly limited to using the approved Design DNA, eliminating "Visual Drift" in the final application.

4. UI Implementation Details

Route: /facade

Components: * PreferenceCollector: Form for visual inputs.

PromptOutput: High-contrast copyable area for the generated Stitch prompt.

StitchImporter: A "Paste & Process" terminal for code extraction.

TokenPreview: A visual grid showing the extracted colors and shapes before syncing.